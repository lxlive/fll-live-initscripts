#!/bin/bash

# XKBMODEL="linux"
# XKBLAYOUT="de"
# XKBVARIANT="nodeadkeys"
. /etc/default/keyboard

# LANG=de_DE.utf8
. /etc/default/locale



case $LANG in
    en_US.utf8)
        sed -e "s/'@LAYOUTS@',//" \
            /usr/share/fll-live-initscripts/91_org.cinnamon.keyboard.input-sources.gschema.override  \
            > /usr/share/glib-2.0/schemas/91_org.cinnamon.keyboard.input-sources.gschema.override
        if [ "${XKBLAYOUT}" != "us" ] ; then
            sed -i -e "s/'us'/'${XKBLAYOUT}'/" \
            /usr/share/glib-2.0/schemas/91_org.cinnamon.keyboard.input-sources.gschema.override
        fi
        ;;
    *)
        XLANG=${LANG:0:2}
        sed -e "s/@LAYOUTS@/${XLANG}/" \
           /usr/share/fll-live-initscripts/91_org.cinnamon.keyboard.input-sources.gschema.override  \
           > /usr/share/glib-2.0/schemas/91_org.cinnamon.keyboard.input-sources.gschema.override
        ;;
esac


glib-compile-schemas /usr/share/glib-2.0/schemas/
